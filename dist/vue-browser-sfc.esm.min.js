var e,t,n="0.2.2",o={};function r(e,t){e.insertAdjacentHTML("beforeend",t)}function a(e){var t=document.querySelectorAll("head style."+e+",head link."+e);if(t.length>0)for(var n=0;n<t.length;n++){var r=t[n],a=parseInt(r.getAttribute(o.styleCounter));a-1>0?r.setAttribute(o.styleCounter,a-1):document.head.removeChild(r)}}function c(e,t,n,r){var a;a={url:n},o.debug&&console.log(a);var c=(new DOMParser).parseFromString(e,"text/html"),u=c.querySelector("template"),l=u?u.innerHTML:"<template></template>";!function(e,t,n){e=e.replaceAll("./",o.basePath+"/").trim();const r="data:text/javascript;charset=utf-8,"+encodeURIComponent(e+"\n//@ sourceURL="+t);import(r).then((e=>{n(e.default??{})}))}(c.querySelector("script")?.innerHTML||"",n,(function(e){e.template=l;var n=c.querySelectorAll("style,link[rel='stylesheet']");if(n.length>0){e.style="\n";for(var a=0;a<n.length;a++){var u=n[a];u&&(u.setAttribute("class",t),u.setAttribute(o.styleCounter,1),e.style+=u.outerHTML+"\n")}}r(e)}))}function u(t,n,u){t.component(n,e((()=>new Promise(((e,t)=>{fetch(u,{cache:"no-cache"}).then((e=>e.text())).then((function(t){t&&c(t,n,u,(function(t){t.created=function(){!function(e,t){var n=document.querySelectorAll("head style."+e+",head link."+e);if(n.length>0)for(var a=0;a<n.length;a++){t=n[a];var c=parseInt(t.getAttribute(o.styleCounter));t.setAttribute(o.styleCounter,c+1)}else t&&r(document.head,t)}(n,t.style)},t.unmounted=function(){a(n)},e(t)}))}))})))))}function l(e,n,r){var a=r();if(!a||"string"==typeof a){if(t(n))return n;var c=o.basePath+o.componentsPath+"/"+n.replaceAll("_","/")+o.componentExt;u(e,n,c),a=r()}return a}function s(n,u,s){var i,h;if(t=n.config.isNativeTag,e=u,o.basePath=document.location.protocol+"//"+document.location.host+(i=s||(document.querySelector("base")?.getAttribute("href")??document.location.pathname),h="/",i.endsWith(h)?i.substr(0,i.length-1):i),window.Vue){var m=Vue.resolveComponent;Vue.resolveComponent=function(e,t){return l(n,e,(()=>m(e,t)))};var f=Vue.resolveDynamicComponent;Vue.resolveDynamicComponent=function(e){return l(n,e,(()=>f(e)))},e=e||Vue.defineAsyncComponent}else n.config.globalProperties.patchComponent=l;var p=n.config.globalProperties.$router;p&&function(e){e.beforeEach(((t,n,r)=>{var a="/"===t.path?o.routerHome:t.path,u=a.substring(1).replaceAll("/","_"),l=o.basePath+o.viewsPath+a+o.componentExt;e.hasRoute(u)?r():fetch(l,{cache:"no-cache"}).then((e=>e.text())).then((function(n){n&&c(n,u,l,(function(n){var o={name:u,path:t.path,component:n,meta:n.meta};e.addRoute(o),e.push({path:t.path,query:t.query})}))}))})),e.beforeResolve((async function(t){var n=e.getRoutes().find((function(e,n){return e.name===t.name}));n.components.default.style&&!document.querySelector("head style."+t.name)&&r(document.head,n.components.default.style)})),e.afterEach((function(e,t){t.name&&e.path!==t.path&&a(t.name)}))}(p)}o.debug=!1,o.basePath="",o.componentsPath="/components",o.viewsPath="/views",o.componentExt=".html",o.styleCounter="data-component-counter",o.routerHome="/home";export{o as config,s as install,l as patchComponent,n as version};
